# 使用 docker compose 快速启动 cc-proxy 代理
version: "3.8"

services:
  cc-proxy:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        DENO_VERSION: ${DENO_VERSION:-2.0.0}
    image: cc-proxy:local
    container_name: cc-proxy
    restart: unless-stopped
    environment:
      HOST: 0.0.0.0
      PORT: 3456
      LOG_LEVEL: info
      UPSTREAM_BASE_URL: https://api.openai.com/v1/chat/completions
      UPSTREAM_API_KEY: changeme-upstream-key
      CLIENT_API_KEY: changeme-client-key
      TIMEOUT_MS: 120000
      MAX_REQUESTS_PER_MINUTE: 60
      TOKEN_MULTIPLIER: "1.0"
      PASSTHROUGH_API_KEY: "false"  # 设置为 true 以启用 API key 透传
      # 渠道配置示例（可选）
      # CHANNEL_1_NAME: elysiver
      # CHANNEL_1_BASE_URL: https://api.elysiver.com/v1/chat/completions
      # CHANNEL_1_API_KEY: sk-elysiver-...
    ports:
      - "3456:3456"
    volumes:
      - ./logs:/app/deno-proxy/logs
    networks:
      - cc-proxy-net

networks:
  cc-proxy-net:
    driver: bridge
